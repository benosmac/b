---
import Layout from "./Layout.astro";
import Gallery from "@components/Gallery.astro";
import { Image } from "@astrojs/image/components";
export interface Props {
  title: string;
  slug: string;
  priority: number;
  maxCols: number;
  customColour: string;
  category: Array<string>;
}
const { frontmatter } = Astro.props;
//Create path to images folder using slug
const pathToImages = `/src/images/${frontmatter.slug}`;
// Get all project images
// required because Vite's import.meta.glob does not accept variables in the path
// returns: Array of image paths
const allImages = Object.keys(
  import.meta.glob("/src/images/**/*.jpg", {
    as: "url",
  })
);
// Filter allImages array using pathToImages
const filteredImages = allImages.filter(
  (image) => image.includes(pathToImages) && !image.includes("feature")
);
const customColour = frontmatter.customColour;
---

<Layout title={frontmatter.title} logoColour={frontmatter.customColour}>
  <section class="description">
    <h1>{frontmatter.title}</h1>
    <slot />
  </section>
  <Gallery images={filteredImages} maxCols={frontmatter.maxCols} />
</Layout>

<style define:vars={{ customColour }}>
  .description {
    grid-column: 1 / span all;
    margin: 2em 2em 0 2em;
  }
  h1 {
    border-bottom: 2px solid var(--customColour);
    padding: 0 0 0.5em 0;
  }
  .description p {
    max-width: 42em;
  }
  @media (min-width: 666px) {
    .description {
      grid-column: 1 / span 4;
    }
  }
</style>
